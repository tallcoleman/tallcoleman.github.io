<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="shortcut icon" type="image/x-icon" href="https://tallcoleman.me/assets/favico.png"> <link rel="stylesheet" href="/assets/main.css" type="text/css" media="screen"> <link rel="stylesheet" href="/assets/print.css" type="text/css" media="print"> <link rel="canonical" href="https://tallcoleman.me/programming/2023/06/13/grouped-reports-excel-power-query.html"> <link rel="alternate" type="application/rss+xml" title="tallcoleman" href="/feed.xml"> <title>Grouped Reports in Excel Using Power Query | tallcoleman</title> <meta name="generator" content="Jekyll v3.9.3"/> <meta property="og:title" content="Grouped Reports in Excel Using Power Query"/> <meta name="author" content="Ben Coleman"/> <meta property="og:locale" content="en_US"/> <meta name="description" content="How to use Power Query in Excel to generate reports with data grouped by category, like in Airtable or Microsoft Access"/> <meta property="og:description" content="How to use Power Query in Excel to generate reports with data grouped by category, like in Airtable or Microsoft Access"/> <link rel="canonical" href="https://tallcoleman.me/programming/2023/06/13/grouped-reports-excel-power-query.html"/> <meta property="og:url" content="https://tallcoleman.me/programming/2023/06/13/grouped-reports-excel-power-query.html"/> <meta property="og:site_name" content="tallcoleman"/> <meta property="og:image" content="https://tallcoleman.me/assets/Images/Ben-By-High-Park-Pond-Birdwatching.JPG"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2023-06-13T00:00:00-04:00"/> <meta name="twitter:card" content="summary_large_image"/> <meta property="twitter:image" content="https://tallcoleman.me/assets/Images/Ben-By-High-Park-Pond-Birdwatching.JPG"/> <meta property="twitter:title" content="Grouped Reports in Excel Using Power Query"/> <script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ben Coleman"},"dateModified":"2023-06-13T00:00:00-04:00","datePublished":"2023-06-13T00:00:00-04:00","description":"How to use Power Query in Excel to generate reports with data grouped by category, like in Airtable or Microsoft Access","headline":"Grouped Reports in Excel Using Power Query","image":"https://tallcoleman.me/assets/Images/Ben-By-High-Park-Pond-Birdwatching.JPG","mainEntityOfPage":{"@type":"WebPage","@id":"https://tallcoleman.me/programming/2023/06/13/grouped-reports-excel-power-query.html"},"url":"https://tallcoleman.me/programming/2023/06/13/grouped-reports-excel-power-query.html"}</script> <script defer src="/scripts/footnotes3.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script defer id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> </head> <body> <header class="site-header" role="banner"> <div class="wrapper"> <a class="site-title" href="/">tallcoleman</a> <nav class="site-nav"> <input type="checkbox" id="nav-trigger" class="nav-trigger"/> <label for="nav-trigger" title="site menu"> <span class="menu-icon"> <svg viewBox="0 0 18 15" width="18px" height="15px"> <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/> <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/> <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/> </svg> </span> </label> <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/about/#contact">Contact</a> <a class="page-link" href="https://osv.tallcoleman.me">Season Graph App</a> </div> </nav> </div> </header> <main class="page-content" aria-label="Content"> <div class="wrapper"> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">Grouped Reports in Excel Using Power Query</h1> <p class="post-meta"><time datetime="2023-06-13T00:00:00-04:00" itemprop="datePublished">Jun 13, 2023</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Ben Coleman</span></span></p> </header> <div class="post-content" itemprop="articleBody"> <p>One of my favourite Airtable features is the <a href="https://support.airtable.com/docs/grouping-records-in-airtable">option to group records</a> in a grid view. It’s such a simple and effective way of organizing information and getting helpful summary info with per-group subtotals. However, now that Airtable is blocked by the firewall at work, I’ve been having to make do with pivot tables or manually grouping data into sections in Excel.</p> <p><img src="https://tallcoleman.me/assets/Images/airtable-grouped-records.png" alt="Screenshot of data on Canadian cities in Airtable with rows grouped by province. There is a heading for each section along with summary functions for certain columns."/></p> <p class="image-caption">An example of grouped records in Airtable</p> <p>Sadly, Excel is way behind when it comes to simple and useful grouping of data <sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">1</a></sup>. Although pivot tables are powerful, they have a terrible UI for custom styles, and can be pretty fiddly. Similarly, Excel’s “group data” features allow you to expand and collapse rows, but row groups don’t dynamically update as data changes, and require a lot of manual upkeep.</p> <p>One Excel feature I do love (well, love-hate) is <a href="https://support.microsoft.com/en-us/office/about-power-query-in-excel-7104fbee-9e62-4cb9-a02e-5bfb1a6c536a">Power Query</a>. It has some quirks, but it offers a lot of power when combined with named table ranges <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">2</a></sup>. It’s a great way to take your existing data and merge tables together or pull a subset of data onto another sheet.</p> <p>So I decided to try making grouped records using a custom Power Query formula <sup id="fnref:5" role="doc-noteref"><a href="#fn:5" class="footnote" rel="footnote">3</a></sup>, and it turned out pretty well! If you want to try it yourself, I’ve included the code and instructions below. Here’s a sneak peek at the final result:</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-print-output-multigroup.png" alt="Print preview of an Excel table with data on Canadian cities grouped by province and municipal status. The group headers are in clear shades of blue with summary totals at the bottom of each section."/></p> <h2 id="instructions">Instructions</h2> <div class="panel panel-info"> <div class="panel-info panel-heading"> <p><strong>Get the Script</strong></p> </div> <p><a href="https://github.com/tallcoleman/power-query-collection/tree/main/GroupByCategory" target="_blank">Get the code for the query formula on GitHub</a>.</p> </div> <p>To use this query formula, you’ll need a <a href="https://support.microsoft.com/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e">named table</a> with data that includes a column for your grouping category. For our example, we’ll use Wikipedia’s <a href="https://en.wikipedia.org/wiki/List_of_the_largest_municipalities_in_Canada_by_population">list of the largest municipalities in Canada</a>.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-city-data.png" alt="Excel table with data on Canadian cities."/></p> <p>To make a grouped list of our data, first we’ll load the data into Power Query using Data &gt; From Table/Range.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-data-from-table-range.png" alt="Screenshot of Excel with a red arrow pointing to the &quot;From Table/Range&quot; menu button."/></p> <p>In the query editor, before we start transforming our data, we’ll first have to set up the custom function. On the left, right-click and then select New Query &gt; Other Sources &gt; Blank Query.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-new-query-blank.png" alt="Screenshot of the Power Query editor showing the menu tree for creating a new blank query."/></p> <p>Rename your new blank query GroupByCategory <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">4</a></sup>, open the Advanced Editor, remove the placeholder text and paste in the <a href="https://github.com/tallcoleman/power-query-collection/blob/main/GroupByCategory/GroupByCategory.pq">script from Github</a>.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-advanced-editor-button.png" alt="Screenshot of the Power Query editor with a red arrow pointing to the &quot;Advanced Editor&quot; button."/></p> <p>The pasted code should look something like this:</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-script-paste.png" alt="Screenshot of function code pasted into the Power Query advanced editor."/></p> <p>With the custom function set up, we can now go back and use it for the city data. In the city data query, open up the advanced editor and add in a new row as follows:</p> <ul> <li>Add a comma to the end of the last row before <code class="language-plaintext highlighter-rouge">in</code>.</li> <li>Just after that row (but still before the <code class="language-plaintext highlighter-rouge">in</code> keyword), add in <code class="language-plaintext highlighter-rouge">#"Grouped Rows" = GroupByCategory(#"Changed Type", {"Province"})</code></li> <li>Change the last line to <code class="language-plaintext highlighter-rouge">#"Grouped Rows"</code>.</li> </ul> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-script-groupby-province.png" alt="Screenshot of the Power Query advanced editor with the described edits to the default code for loading in data from a table."/></p> <p>Now, you can select “Close &amp; Load” and Excel will insert a new tab with your output table. It still needs some formatting work, but you can see it’s now grouped our data by province.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-raw-output-groupby-province.png" alt="Screenshot of an unformatted query data table loaded into Excel. The table is in the default green colour with column widths auto-set by contents."/></p> <h3 id="wait-what-did-i-just-do">Wait, What Did I Just Do??</h3> <p>In case you haven’t used the advanced editor before, this is what’s happening — the code for Power Query transform operations is written in a format like this, with all lines in each section except for the last one separated by commas:</p> <pre><code class="language-pq">let
  Source = &lt;&lt;expression that loads in your data&gt;&gt;,
  #"Step A", // applies a transformation to Source
  #"Step B" // applies a transformation to #"Step A"
in
  #"Step B" // step you want the output from
</code></pre> <p>When you use the Power Query menu to do things like remove or reorder columns, or change data types, the program generates this code behind the scenes. Occasionally, when you need to do something more complex, you have to edit the code directly, like we did here.</p> <p>In our case, we added a step that calls our custom function <code class="language-plaintext highlighter-rouge">GroupByCategory</code>, which has two required arguments:</p> <ul> <li>The table you want it to process (in our case, the output from the <code class="language-plaintext highlighter-rouge">#"Changed Type"</code> step).</li> <li>A list of the names of the columns that should be used to group the data. In our case, there was only one item in our list, but you’ll see an example at the end of grouping by more than one column.</li> </ul> <p>Our function then spits out a table with the data grouped, heading rows added, etc.</p> <p>If you want to learn more about the code behind Power Query, you can read through the documentation for the <a href="https://learn.microsoft.com/en-us/powerquery-m/">Power Query M formula language</a>, though be warned that it may be a bit challenging in places if you’re not familiar with computer programming jargon. If you search for “M Query Beginner” you’ll probably find some blogs and videos that have clearer and more example-based explanations.</p> <h3 id="formatting-your-table">Formatting Your Table</h3> <p>To make our table look a little more presentable, let’s format it a little bit.</p> <p>Before we dive in, let’s make sure we can manually control the column widths by changing the table properties. First, select any cell of the table, then select the “Properties” button in the “Table Design” section of the ribbon.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-table-properties.png" alt="Screenshot of Excel with a red arrow pointing to the table &quot;Properties&quot; menu."/></p> <p>Uncheck “Adjust column width” and select OK.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-table-properties-menu.png" alt="Screenshot of the &quot;External Data Properties&quot; settings window. The window is small and has several checkboxes and radio buttons."/></p> <p>This will stop the table from auto-fitting the column widths when we refresh our data.</p> <p>We also want to hide the StyleIndex column, which can be done by just hiding the column or by excluding it from the print area. To change the print area, select the columns you want to be printed, and then select Page Layout &gt; Print Area &gt; Set Print Area:</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-set-print-area.png" alt="Screenshot of Excel showing the &quot;Print Area&quot; menu button."/></p> <p>For the table itself, we can do some pretty simple formatting:</p> <ul> <li>Choose a different table colour scheme from the Table Design menu in the ribbon</li> <li>Resize the H_Province column to e.g. 3 units and hide the heading title by changing the text colour of B1 to match the background</li> <li>Apply some number formatting where needed (e.g. changing the Growth Rate column to percentages)</li> </ul> <p>At the end, our table now looks something like this:</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-basic-format-groupby-province.png" alt="Screenshot of formatted data table. The colour scheme is now black, white, and grey, column widths are custom-set, and group heading have been bolded."/></p> <h3 id="inline-layout">Inline Layout</h3> <p>By default, the function will output a table in “Outline” style with a new column added on the left for each grouping level. This gives some visual indentation and allows you to easily format the headings by formatting just the heading column.</p> <p>However, you can also choose an “Inline” style where the headings are put in the first data column instead. To do this, we’re just going to add an option to our function call in the script using the optional third argument of the function, which lets us configure how the function works <sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">5</a></sup>. Now our function line will look something like this:</p> <p><code class="language-plaintext highlighter-rouge">#"Grouped Rows" = GroupByCategory(#"Changed Type", {"Province"}, [HeadingStyle = "Inline"])</code></p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-script-headingstyle-inline.png" alt="Screenshot of the Power Query advanced editor with the changed function arguments."/></p> <p>To get our bolded heading, we’re going to have to use some conditional formatting. With our table data selected, select Home &gt; Conditional Formatting &gt; Manage Rules &gt; New Rule and set up a formula rule with the function set to <code class="language-plaintext highlighter-rouge">=$A2="Heading1"</code> (where $A2 is the first cell in the selected range). In this case, I’ve also set the text format for this rule to “bold”.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-conditional-format-inline.png" alt="Screenshot of the conditional formatting menu window. The top section has &quot;Use a formula...&quot; selected, the middle section contains a formula, and the bottom section has a formatting preview."/></p> <p>Our result should look something like this:</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-output-inline.png" alt="Screenshot of a formatted data table. The inline headings are bolded and the StyleIndex column is clearly outside of the print area as demarked by a thick blue border."/></p> <p>Note that for the Inline style, the group headings are in the first column (“Rank (2021)”) instead of in their own column to the left of the data.</p> <p>The benefit of conditional formatting is that it should continue to work as intended, even as your table grows or shrinks. With everything set up, when you need to use the table, all you’ll need to do is refresh the data (Right-click table and select “Refresh” or Data &gt; Refresh All in the ribbon).</p> <h3 id="adding-summary-functions">Adding Summary Functions</h3> <p>In many cases, it’s also helpful to have automatic subtotals for certain columns show for each group. Let’s set that up now.</p> <p>Go back into the query editor (Data &gt; Queries &amp; Connections &gt; Right-Click and select “Edit”), open up the Advanced Editor again and add in the following line and function option:</p> <pre><code class="language-pq">SummaryFunctions = [
  #"Rank (2021)" = List.Average,
  #"Population (2021)" = List.Sum meta [Name = "Total"],
  #"Population (2016)" = List.Sum meta [Name = "Total"],
  #"Growth rate (2016-2021)" = List.Average,
  #"Land area (km2, 2021)" = List.Sum meta [Name = "Total"]
  ],
#"Grouped Rows" = GroupByCategory (#"Changed Type", 
  {"Province"}, [SummaryFunctions = SummaryFunctions])
</code></pre> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-script-summary-functions.png" alt="Screenshot of the Power Query advanced editor with the summary function code added in."/></p> <p>What we’ve done here is define a <a href="https://learn.microsoft.com/en-us/powerquery-m/m-spec-values#record">Record</a> of summary functions to apply to specific columns, and provided that Record as an option for our function.</p> <p>By default, the function will also add in a row at the top with labels for the summary functions so that it’s clear which column has averages vs totals, etc. For the <a href="https://learn.microsoft.com/en-us/powerquery-m/list-functions">built in List functions</a> the name comes from the function itself, e.g. <code class="language-plaintext highlighter-rouge">List.Sum</code> would be labeled “Sum”. However, you can provide your own labels by adding a <a href="https://learn.microsoft.com/en-us/powerquery-m/metadata">metadata field</a> <code class="language-plaintext highlighter-rouge">Name</code> like you can see in the example above, where we want our Sum functions to be labeled “Total” instead. The metadata label can also be used if you want to use your own custom functions for summarizing a column.</p> <p>Here’s what the output will look like (with some additional steps we’ll get into just below) — you can see we have per-group averages for the Rank column and per-group subtotals for the Population column.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-output-multigroup.png" alt="Screenshot of a formatted data table. The group headings are in shades of blue, with summary functions below each group."/></p> <h3 id="grouping-by-multiple-columns">Grouping by Multiple Columns</h3> <p>You might have also noticed in the example above that we have multiple groups, with the data grouped by Province, and then within each Province by Municipal Status.</p> <p>To set this up, we just have to make a small change to our function line in the code so that we list both our grouping columns in the desired order:</p> <pre><code class="language-pq">#"Grouped Rows" = GroupByCategory (#"Changed Type", 
  {"Province", "Municipal status"}, 
  [SummaryFunctions = SummaryFunctions]
  )
</code></pre> <p>This will now give us heading and summary rows for each grouping column, so let’s set up some more advanced conditional formatting to make the data structure clearer:</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-conditional-format-multigroup.png" alt="Screenshot of the conditional formatting rules manager window showing three formula-based rules to set the blue headings for each group level and to apply a white background to blank rows."/></p> <p>(In this case, I’ve selected entire columns instead of just the table data, so the first cell in my range is $A1).</p> <p>Also, it’s not obvious from the formatting options in the screenshot above, but the blank rows have a white background applied to override the alternating colours from the table style.</p> <p>This should now be everything we need to get our formatted, multi-grouped table:</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-output-multigroup.png" alt="Repeat of the screenshot of a formatted data table. The group headings are in shades of blue, with summary functions below each group."/></p> <h3 id="some-printing-tips">Some Printing Tips</h3> <p>In addition to hiding the StyleIndex column or excluding it from the print area, there are two small details you may want to set up if you want to print your table or save it to PDF:</p> <p>First, you can have the heading row and summary function labels repeat on each page by going to Page Layout &gt; Page Setup &gt; Sheet and selecting these rows using the “Rows to repeat at top” control.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-page-setup-menu.png" alt="Screenshot of the Page Setup menu in Excel. The &quot;Rows to Repeat&quot; formula box reads &quot;$1:$2&quot;"/></p> <p>Second, in the Page Layout section of the ribbon, you may also want to change the page orientation to Landscape and set the Width to 1 Page if you have a lot of columns and want them all on the same page.</p> <p>Finally, after you’ve refreshed your table data, you may want to adjust where the page breaks are by selecting the page break preview in the view options on the bottom-right hand corner of the application window (next to the zoom control). Once you’re in Page Break Preview, you can drag the break lines up as needed. If you ever need to reset the breaks and set them again from scratch, go to Page Layout &gt; Breaks &gt; Reset All Page Breaks.</p> <p>With these options applied, you’ll have a print output that looks something like this:</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-print-output-multigroup.png" alt="Repeat of the print preview of an Excel table with data on Canadian cities grouped by province and municipal status. The group headers are in clear shades of blue with summary totals at the bottom of each section."/></p> <h2 id="final-thoughts">Final Thoughts</h2> <p>This process may feel like a lot of steps, especially if you’ve never used many of these Excel features before. However, compared to setting up a grouped report in Microsoft Access or the Power BI Report Builder, using this custom function will be a lot easier for many people.</p> <p>For simpler cases, Pivot Tables might be a more straightforward solution, though I’ve often found them incredibly frustrating to format.</p> <p>If you really want to have some fun, you can also set up another table to specify your grouping columns and make your sheet into more of an interactive report generator. I’ll leave that as an exercise for the reader.</p> <p>There are still some unavoidable drawbacks to using Excel instead of Airtable. For example, you can’t edit your data directly in the grouped output table, and Excel for Mac doesn’t quite have the same number of Power Query features as the Windows version (<a href="https://insider.microsoft365.com/en-us/blog/shape-data-with-power-query-editor-in-excel-for-mac">though it’s quickly catching up</a>).</p> <p>However, when Excel is the tool you need to use, I think this is a useful tool to have. I hope you find it useful too! If you run into any bugs or issues, make sure to flag them on the <a href="https://github.com/tallcoleman/power-query-collection/issues">Github Issues Page</a>.</p> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:4" role="doc-endnote"> <p>Hot take: this use case is something that Apple Numbers is actually better at than Excel. See: <a href="https://support.apple.com/en-ca/guide/numbers/tan7cfc99b73/mac">Modify category groups in Numbers on Mac</a> and <a href="https://support.apple.com/en-ca/guide/numbers/tan3ec8281cf/13.0/mac/1.0">Add calculations to category groups in Numbers on Mac</a>.</p> <p><img src="https://tallcoleman.me/assets/Images/pqgroup-apple-numbers-example.png" alt="Screenshot of data on Canadian cities in Apple Numbers grouped by province."/> <a href="#fnref:4" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> <li id="fn:1" role="doc-endnote"> <p>For those that don’t know, you can take a named table range, select “From Table/Range” in the Data tab, and then “Close &amp; Load To…” with the option to “Only Create Connection”. This sets up a query for your table data that you can then reference in other queries, e.g. via “Merge Queries”. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> <li id="fn:5" role="doc-endnote"> <p>Shout out to <a href="https://xcelanz.com/power-query-add-blank-row-at-each-change-in-value/">this great post by Livio on XcelanZ.com</a> which helped me figure out how to code in the blank rows between sections. <a href="#fnref:5" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> <li id="fn:2" role="doc-endnote"> <p>Because the function is recursive, if you want to use another name, you’ll also have to change the <code class="language-plaintext highlighter-rouge">@GroupByCategory</code> reference near the end of the script to match your function name. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> <li id="fn:3" role="doc-endnote"> <p>The full list of options can be found in the mega-comment at the top of the function script itself. <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> </ol> </div> </div> </article> </div> </main> <footer class="site-footer"> <div class="wrapper"> <div class="footer-col-wrapper"> <div class="footer-col footer-col-1"> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"/></a> </div> <div class="footer-col footer-col-2"> </div> <div class="footer-col footer-col-3"> <p>A Blog on Politics, Nature, and Culture </p> </div> </div> </div> </footer> <script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-96738049-1","auto"),ga("send","pageview");</script> </body> </html>